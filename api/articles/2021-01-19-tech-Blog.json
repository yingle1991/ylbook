{"title":"tomcat https访问部署","slug":"2021-01-19-tech-Blog","date":"2021-01-18T16:00:00.000Z","updated":"2021-11-08T12:52:11.644Z","comments":true,"path":"api/articles/2021-01-19-tech-Blog.json","excerpt":"自签名证书利用java命令生成自定义签名证书1<br>2<br>3<br>keytool -genkey -alias tomcat -keypass 123456 -keyalg &quot;RSA&quot; -keystore &quot;e:\\tomcat.keystore&quot; <br>&#x2F;&#x2F;可执行后输入<br>-storepass 123456<br>","covers":["https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210119220222540.png","https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120142402734.png","https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120142912182.png","https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120150406141.png","https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120090953789.png","https://gitee.com/yingle1991/resource/raw/master/static/blog/passme.png"],"content":"<h6 id=\"自签名证书\"><a href=\"#自签名证书\" class=\"headerlink\" title=\"自签名证书\"></a>自签名证书</h6><ol>\n<li><p>利用java命令生成自定义签名证书</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">keytool -genkey -alias tomcat -keypass 123456 -keyalg &quot;RSA&quot; -keystore &quot;e:\\tomcat.keystore&quot; </span><br><span class=\"line\">&#x2F;&#x2F;可执行后输入</span><br><span class=\"line\">-storepass 123456</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n\n\n</li>\n</ol>\n<img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210119220222540.png\" alt=\"image-20210119220222540\" style=\"zoom:80%;\" />\n\n<ol start=\"2\">\n<li>tomcat 服务器修改server.xml</li>\n</ol>\n<p>   将8443端口注释放出来 (默认是8443 但是https请求需要带端口号，改成443端口便不用带端口号访问)</p>\n   <img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120142402734.png\" alt=\"image-20210120142402734\" style=\"zoom:80%;\" />\n\n   <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;Connector port&#x3D;&quot;443&quot; protocol&#x3D;&quot;org.apache.coyote.http11.Http11Protocol&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">        maxThreads&#x3D;&quot;150&quot; SSLEnabled&#x3D;&quot;true&quot; scheme&#x3D;&quot;https&quot; secure&#x3D;&quot;true&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">        clientAuth&#x3D;&quot;false&quot; sslProtocol&#x3D;&quot;TLS&quot; </span><br><span class=\"line\"></span><br><span class=\"line\">        keystoreFile&#x3D;&quot;E:\\tomcat.keystore&quot; </span><br><span class=\"line\"></span><br><span class=\"line\">        keystorePass&#x3D;&quot;123456&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure>\n\n<p>   将 http请求重定向到https</p>\n<p>   修改conf.xml</p>\n<p>   <img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120142912182.png\" alt=\"image-20210120142912182\"></p>\n   <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;Connector port&#x3D;&quot;8080&quot; protocol&#x3D;&quot;HTTP&#x2F;1.1&quot;</span><br><span class=\"line\">           connectionTimeout&#x3D;&quot;20000&quot;</span><br><span class=\"line\">           redirectPort&#x3D;&quot;443&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure>\n\n<p>   修改web.xml</p>\n<p>   <img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120150406141.png\" alt=\"image-20210120150406141\"></p>\n   <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    &lt;login-config&gt;    </span><br><span class=\"line\">    &lt;!-- Authorization setting for SSL --&gt;    </span><br><span class=\"line\">    &lt;auth-method&gt;CLIENT-CERT&lt;&#x2F;auth-method&gt;    </span><br><span class=\"line\">    &lt;realm-name&gt;Client Cert Users-only Area&lt;&#x2F;realm-name&gt;    </span><br><span class=\"line\">&lt;&#x2F;login-config&gt;    </span><br><span class=\"line\">&lt;security-constraint&gt;    </span><br><span class=\"line\">    &lt;!-- Authorization setting for SSL --&gt;    </span><br><span class=\"line\">    &lt;web-resource-collection &gt;    </span><br><span class=\"line\">        &lt;web-resource-name &gt;SSL&lt;&#x2F;web-resource-name&gt;    </span><br><span class=\"line\">        &lt;url-pattern&gt;&#x2F;*&lt;&#x2F;url-pattern&gt;    </span><br><span class=\"line\">    &lt;&#x2F;web-resource-collection&gt;    </span><br><span class=\"line\">    &lt;user-data-constraint&gt;    </span><br><span class=\"line\">        &lt;transport-guarantee&gt;CONFIDENTIAL&lt;&#x2F;transport-guarantee&gt;    </span><br><span class=\"line\">    &lt;&#x2F;user-data-constraint&gt;    </span><br><span class=\"line\">&lt;&#x2F;security-constraint&gt;</span><br></pre></td></tr></table></figure>\n\n<p>   测试成功，但是这个一般都会报不安全,而且小程序是不支持该种方式的https请求的</p>\n<p><img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120090953789.png\" alt=\"image-20210120090953789\"></p>\n<h6 id=\"阿里云免费证书\"><a href=\"#阿里云免费证书\" class=\"headerlink\" title=\"阿里云免费证书\"></a>阿里云免费证书</h6><p>​    登录阿里云在控制台可免费申请20个SSL认证证书，虽不保证安全，但是小程序是允许这种加密方式调用的，因此需要在阿里云申请免费的证书替换自定义生成的即可使用</p>\n<p>分享程序员的理财、生活！我是乐子，多多指教！</p>\n<p> <img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/passme.png\" alt=\"关注我得到更多信息\"></p>\n","more":"</li>\n</ol>\n<img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210119220222540.png\" alt=\"image-20210119220222540\" style=\"zoom:80%;\" />\n\n<ol start=\"2\">\n<li>tomcat 服务器修改server.xml</li>\n</ol>\n<p>   将8443端口注释放出来 (默认是8443 但是https请求需要带端口号，改成443端口便不用带端口号访问)</p>\n   <img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120142402734.png\" alt=\"image-20210120142402734\" style=\"zoom:80%;\" />\n\n   <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;Connector port&#x3D;&quot;443&quot; protocol&#x3D;&quot;org.apache.coyote.http11.Http11Protocol&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">        maxThreads&#x3D;&quot;150&quot; SSLEnabled&#x3D;&quot;true&quot; scheme&#x3D;&quot;https&quot; secure&#x3D;&quot;true&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">        clientAuth&#x3D;&quot;false&quot; sslProtocol&#x3D;&quot;TLS&quot; </span><br><span class=\"line\"></span><br><span class=\"line\">        keystoreFile&#x3D;&quot;E:\\tomcat.keystore&quot; </span><br><span class=\"line\"></span><br><span class=\"line\">        keystorePass&#x3D;&quot;123456&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure>\n\n<p>   将 http请求重定向到https</p>\n<p>   修改conf.xml</p>\n<p>   <img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120142912182.png\" alt=\"image-20210120142912182\"></p>\n   <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;Connector port&#x3D;&quot;8080&quot; protocol&#x3D;&quot;HTTP&#x2F;1.1&quot;</span><br><span class=\"line\">           connectionTimeout&#x3D;&quot;20000&quot;</span><br><span class=\"line\">           redirectPort&#x3D;&quot;443&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure>\n\n<p>   修改web.xml</p>\n<p>   <img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120150406141.png\" alt=\"image-20210120150406141\"></p>\n   <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    &lt;login-config&gt;    </span><br><span class=\"line\">    &lt;!-- Authorization setting for SSL --&gt;    </span><br><span class=\"line\">    &lt;auth-method&gt;CLIENT-CERT&lt;&#x2F;auth-method&gt;    </span><br><span class=\"line\">    &lt;realm-name&gt;Client Cert Users-only Area&lt;&#x2F;realm-name&gt;    </span><br><span class=\"line\">&lt;&#x2F;login-config&gt;    </span><br><span class=\"line\">&lt;security-constraint&gt;    </span><br><span class=\"line\">    &lt;!-- Authorization setting for SSL --&gt;    </span><br><span class=\"line\">    &lt;web-resource-collection &gt;    </span><br><span class=\"line\">        &lt;web-resource-name &gt;SSL&lt;&#x2F;web-resource-name&gt;    </span><br><span class=\"line\">        &lt;url-pattern&gt;&#x2F;*&lt;&#x2F;url-pattern&gt;    </span><br><span class=\"line\">    &lt;&#x2F;web-resource-collection&gt;    </span><br><span class=\"line\">    &lt;user-data-constraint&gt;    </span><br><span class=\"line\">        &lt;transport-guarantee&gt;CONFIDENTIAL&lt;&#x2F;transport-guarantee&gt;    </span><br><span class=\"line\">    &lt;&#x2F;user-data-constraint&gt;    </span><br><span class=\"line\">&lt;&#x2F;security-constraint&gt;</span><br></pre></td></tr></table></figure>\n\n<p>   测试成功，但是这个一般都会报不安全,而且小程序是不支持该种方式的https请求的</p>\n<p><img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/image-20210120090953789.png\" alt=\"image-20210120090953789\"></p>\n<h6 id=\"阿里云免费证书\"><a href=\"#阿里云免费证书\" class=\"headerlink\" title=\"阿里云免费证书\"></a>阿里云免费证书</h6><p>​    登录阿里云在控制台可免费申请20个SSL认证证书，虽不保证安全，但是小程序是允许这种加密方式调用的，因此需要在阿里云申请免费的证书替换自定义生成的即可使用</p>\n<p>分享程序员的理财、生活！我是乐子，多多指教！</p>\n<p> <img src=\"https://gitee.com/yingle1991/resource/raw/master/static/blog/passme.png\" alt=\"关注我得到更多信息\"></p>","categories":[],"tags":[{"name":"技术","path":"api/tags/技术.json"},{"name":"运维","path":"api/tags/运维.json"}]}